"use strict";(self.webpackChunkorinoco_frontend=self.webpackChunkorinoco_frontend||[]).push([[511],{176:(t,e,a)=>{a.d(e,{v:()=>n});const n={API_URL:"http://localhost:3000/api/cameras"}},943:(t,e,a)=>{var n=a(274),r=a(880),s=a(558),o=a(64),d=(a(9),a(102));const i=new n.A("cart");class c{createTr(t,e){let a=(0,s.l)("tr");a.innerHTML=e,t.appendChild(a)}quantitySelect(t){for(var e=1,a=[];e<=10;)a.push(e),e++;return a.map((e=>t===e?`<option value="${e}" selected>${e}</option>`:`<option value="${e}">${e}</option>`))}trBody(t,e){return`\n                <th scope="row"><img src="${t.imageUrl}" class="img-fluid" width="300px" height="300px" alt="${t.name}"></th>\n                <td>${t.name}</td>\n                <td>${(0,r.Y)(t.price)}</td>\n                <td class="text-center">\n                    <label for="cartQuantity${e}">\n                    <select data-id="${t._id}" id="cartQuantity${e} form-select" aria-label="Selection quantité">\n                        ${this.quantitySelect(t.quantity)}\n                    </select>      \n                    </label>\n            \n                </td>\n                <td>${(0,r.Y)(t.price*t.quantity)}</td>\n                <td class="text-center"><button class="btn btn-secondary btn-sm delProduct rounded-circle" data-id="${t._id}" data-bs-toggle="tooltip" data-bs-placement="left" title="Retirer du panier"><i class="fas fa-minus-circle"></i></button></td>\n            `}trFoot(t){return`\n                <th scope="row"><b>Total</b></th>\n                <td scope="row">&nbsp;</td>\n                <td scope="row">&nbsp;</td>\n                <td class="text-center"><b> articles</b></td>\n                <td><b>${(0,r.Y)(i.totalPrice(t))}</b></td>\n                <td class="text-center"><button id="clearCart" class="btn btn-danger btn-sm rounded-circle" data-bs-toggle="tooltip" data-bs-placement="left" title="Vider le panier"><i class="fas fa-ban"></i></td> \n            `}create(){if(null===i.get()||0===i.get().data.length)document.querySelector("#cartSection .container").innerHTML="Votre panier est vide",(0,s.b)("form");else{var t=document.querySelector("tbody");t.innerHTML="";var e=document.querySelector("tfoot");e.innerHTML="";var a=1;i.get().data.forEach((e=>{this.createTr(t,this.trBody(e,a)),a++})),this.createTr(e,this.trFoot(i.get().data)),this.refresh()}}refresh(){(0,o.s9)(i,this,(0,d.F)())}}const l={firstName:!1,lastName:!1,address:!1,city:!1,email:!1};const u=l;var h=a(956),m=a(176),p=a(169);const f=m.v.API_URL,b=new h.r(f,"application/json"),v=new n.A("cart"),g=new n.T("confirmation"),y=new c;function $(t){var e={};return t.querySelectorAll("input").forEach((t=>{var a=t.name,n=t.value;a&&(e[a]=n)})),e}(new c).create(),function(){console.log(u);var t=document.getElementById("formToJson");t&&t.addEventListener("submit",(function(e){e.preventDefault();try{if(Object.values(u).every((t=>!0===t))){console.log("ok");var a={contact:$(this),products:(n=[],v.get().data.forEach((t=>{n.push(t._id)})),n)};console.log(a.contact),b.send(a).then((t=>{!function(t){var e=document.getElementById("modalConfirm"),a=(0,s.l)("div",{class:"modal-dialog"});a.innerHTML=`\n        <div class="modal-content">\n            <div class="modal-header">\n            <h5 class="modal-title">Votre commande</h5>\n            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n            </div>\n            <div class="modal-body">\n                <p>Merci ${t.contact.firstName} pour votre achat</p>\n                <p>Votre commande est en cours de traitement</p>\n            </div>\n            <div class="modal-footer">\n            <a href="/confirmation.html" class="btn btn-secondary">Voir mes commandes</a>\n            </div>\n        </div>\n        `,e.appendChild(a),new p.u_(e).show(),e.addEventListener("hidden.bs.modal",(function(){e.innerHTML=""}));let n=(0,s.l)("div");n.innerHTML=`\n        <label for="orderId">Votre numéro de commande : </label>\n        <input class="form-control" type="text" value="${t.orderId}" aria-label="Entrée désactiver" disabled>\n        `,document.querySelector(".modal-body").appendChild(n)}(t),g.add(t),v.delAll(),y.create()}))}}catch(a){console.error(a),e.preventDefault(),e.stopPropagation(),t.classList.add("was-validated")}var n}),!1)}(),function(){const t=document.querySelectorAll("input"),e={firstName:/^[a-zA-Z\d]{1,20}$/,lastName:/^[a-zA-Z\d]{1,20}$/,address:/[a-z0-9]$/,city:/^(?:[0-8]\d|9[0-8])\d{3} [a-zA-Z]+(?:[\s-][a-zA-Z]+)*$/,email:/^([a-z\d\.-]+)@([a-z\d-]+)\.([a-z]{2,8})(\.[a-z]{2,8})?$/,quantity:/\b([1-9]|10)\b/};t.forEach((t=>{t.addEventListener("keyup",(t=>{var a;a=t.target,e[t.target.attributes.id.value].test(a.value)?(a.className="form-control is-valid",l[`${a.id}`]=!0):(a.className="form-control is-invalid",l[`${a.id}`]=!1)}))}))}(),(0,d.F)()},64:(t,e,a)=>{a.d(e,{wv:()=>r,s9:()=>s});a(102);function n(t={},e,a){if(t.el)document.querySelector(t.el).addEventListener(e,a);else if(t.els){document.querySelectorAll(t.els).forEach((t=>{t.addEventListener(e,a)}))}}function r(t,e,a){n({el:"#addProduct"},"click",(()=>{t.add(e)}))}function s(t,e,a){n({els:"button[data-id]"},"click",(a=>{let n=a.target.dataset.id;console.log(n),t.del(n),e.create()})),n({els:"[id^=cartQuantity]"},"change",(n=>{let r=n.target.dataset.id;t.updateQuantity(r,n.target),e.create(),a()})),n({el:"#clearCart"},"click",(()=>{t.delAll(),e.create(),a()}))}},102:(t,e,a)=>{a.d(e,{F:()=>r});const n=new(a(274).A)("cart");function r(){const t=document.getElementById("cart-nb");void 0===n.count()?t.innerHTML="":t.innerHTML=n.count()}},956:(t,e,a)=>{a.d(e,{r:()=>n});class n extends class{constructor(t={}){this._baseURL=t.baseURL||"",this._headers=t.headers||{}}async _fetchJSON(t,e={}){const a=await fetch(this._baseURL+t,{...e,headers:this._headers});if(!a.ok)throw new Error(a.statusText);if(!1!==e.parseResponse&&204!==a.status)return a.json()}setHeader(t,e){return this._headers[t]=e,this}getHeader(t){return this._headers[t]}get(t,e={}){return this._fetchJSON(t,{...e,method:"GET"})}post(t,e,a={}){return this._fetchJSON(t,{...a,body:e?JSON.stringify(e):void 0,method:"POST"})}}{constructor(t,e){super({baseURL:t,headers:{Accept:e,"Content-Type":e}})}load(){return this.get("/")}loadById(t){return this.get(`/${t}`)}send(t){return this.post("/order",t)}}},880:(t,e,a)=>{function n(t){var e=t/100+".00";return Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(e)}a.d(e,{Y:()=>n})},274:(t,e,a)=>{a.d(e,{A:()=>s,T:()=>d});var n=a(9);class r{constructor(t){this.name=t||""}check(){if(null===this.get())var t={data:[]};else t=this.get();return t}set(t){return localStorage.setItem(this.name,JSON.stringify(t))}get(){return JSON.parse(localStorage.getItem(this.name))}updateQuantity(t,e){var a=this.get(),n=a.data.find((e=>e._id===t)),r=parseInt(e.value);n&&(n.quantity=parseInt(r)),this.set(a)}del(t){var e=this.get().data.findIndex((e=>e._id===t)),a=this.get();a.data.splice(e,1),this.set(a)}delAll(){localStorage.removeItem(this.name)}}class s extends r{add(t){this.set(this.check());var e=this.get(),a=e.data.find((e=>e._id===t._id));t.quantity=parseInt(document.getElementById("btnQuantity").value),a?a.quantity>=10?(0,n.j)(".card-body","Il reste 10 produits en stock","danger",!0):(a.quantity+=parseInt(t.quantity),(0,n.j)(".card-body","Le produit a été ajouter au panier","success",!0)):(e.data.push({name:t.name,imageUrl:t.imageUrl,_id:t._id,quantity:t.quantity,price:t.price}),(0,n.j)(".card-body","Le produit a été ajouter au panier","success",!0)),this.set(e)}totalPrice(){let t=0;return this.get().data.forEach((e=>{t+=e.price*e.quantity})),t}count(){var t;if(null!==this.get()&&0!==this.get().data){let e=this.get().data;return t=0,e.forEach((e=>{t+=e.quantity})),console.log(t),t}t=null}}const o=new s("cart");class d extends r{add(t){this.set(this.check());var e=this.get(),a=new Date;e.data.push({contact:t.contact,orderId:t.orderId,products:t.products,date:a,totalPrice:this.totalPrice(o.get().data)}),this.set(e)}totalPrice(){let t=0;return this.get().data.forEach((e=>{t+=e.price*e.quantity})),t}}}},t=>{var e;e=943,t(t.s=e)}]);