"use strict";(self.webpackChunkorinoco_frontend=self.webpackChunkorinoco_frontend||[]).push([[511],{857:(t,e,n)=>{var a=n(274),r=n(880),s=n(558);class o extends s.gp{quantitySelect(t){for(var e=1,n=[];e<=10;)n.push(e),e++;return n.map((e=>t===e?`<option value="${e}" selected>${e}</option>`:`<option value="${e}">${e}</option>`)).join("")}trBody(t,e){return`\n                <th scope="row"><img src="${t.imageUrl}" class="img-fluid" alt="${t.name}"></th>\n                <td>${t.name}</td>\n                <td>${(0,r.Y)(t.price)}</td>\n                <td class="text-center">\n                    <label for="cartQuantity${e}">\n                    <select class="form-select" data-id="${t._id}" id="cartQuantity${e}" aria-label="Selection quantité">\n                        ${this.quantitySelect(t.quantity)}\n                    </select>      \n                    </label>\n            \n                </td>\n                <td>${(0,r.Y)(t.price*t.quantity)}</td>\n                <td class="text-center"><button class="btn btn-secondary btn-sm delProduct rounded-circle" data-id="${t._id}" data-bs-toggle="tooltip" data-bs-placement="left" title="Retirer du panier"><span class="fas fa-minus-circle"></span></button></td>\n            `}create(t,e){this.createNode(this.trBody(t,e))}}class i extends s.gp{trFoot(t){return`\n                <th scope="row"><b>Total</b></th>\n                <td>&nbsp;</td>\n                <td>&nbsp;</td>\n                <td id="totalProduct" class="text-center"><b>${t.count()} articles</b></td>\n                <td id="totalPrice"><b>${(0,r.Y)(t.totalPrice())}</b></td>\n                <td class="text-center"><button id="clearCart" class="btn btn-danger btn-sm rounded-circle" data-bs-toggle="tooltip" data-bs-placement="left" title="Vider le panier"><i class="fas fa-ban"></i></td> \n            `}create(t){this.createNode(this.trFoot(t))}}var d=n(506);const l={firstName:!1,lastName:!1,address:!1,city:!1,email:!1};const c=l;var u=n(169);var m=n(9);const p=new d._("http://localhost:3000",{Accept:"application/json","Content-Type":"application/json"});function h(t){var e={};return t.querySelectorAll("input").forEach((t=>{var n=t.name,a=t.value;n&&(e[n]=a)})),e}var y,f=n(161),b=n(102);!function(){if(a.N.isEmpty())document.querySelector(".table-responsive").innerHTML="Votre panier est vide",document.querySelector("#formSection").remove();else{const e=new o("tr",{},"tbody"),n=new i("tr",{},"tfoot");var t=1;a.N.get().forEach((n=>{e.create(n,t),t++})),n.create(a.N),(0,f.qU)(),(0,f.XW)(),(0,f.ts)()}}(),(y=document.getElementById("formToJson"))&&y.addEventListener("submit",(function(t){t.preventDefault();try{if(Object.values(c).every((t=>!0===t))){var e={contact:h(this),products:(n=[],a.N.get().forEach((t=>{n.push(t._id)})),n)};p.post("/api/cameras/order",e).then((t=>{!function(t){var e=document.getElementById("modalConfirm"),n=(0,s.ln)("div",{class:"modal-dialog"});n.innerHTML=`\n        <div class="modal-content">\n            <div class="modal-header">\n            <h5 class="modal-title">Votre commande</h5>\n            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n            </div>\n            <div class="modal-body">\n                <p>Merci ${t.contact.firstName} pour votre achat</p>\n                <p>Votre commande est en cours de traitement</p>\n            </div>\n            <div class="modal-footer">\n            <a href="/confirmation.html" class="btn btn-secondary">Voir mes commandes</a>\n            </div>\n        </div>\n        `,e.appendChild(n),new u.u_(e).show(),e.addEventListener("hidden.bs.modal",(function(){e.innerHTML=""}));let a=(0,s.ln)("div");a.innerHTML=`\n        <label for="orderId">Votre numéro de commande : </label>\n        <input class="form-control" type="text" value="${t.orderId}" aria-label="Entrée désactiver" disabled>\n        `,document.querySelector(".modal-body").appendChild(a)}(t),a.y.add(t),a.N.delAll()}))}else t.preventDefault(),t.stopPropagation(),y.classList.add("was-validated")}catch(t){(0,m.j)("#main .container","Erreur lors de l'envoi des données","danger",!1),console.error(t)}var n}),!1),function(){const t=document.querySelectorAll("input"),e={firstName:/^[a-zA-Z\d]{1,20}$/,lastName:/^[a-zA-Z\d]{1,20}$/,address:/[a-z0-9]$/,city:/^(?:[0-8]\d|9[0-8])\d{3} [a-zA-Z]+(?:[\s-][a-zA-Z]+)*$/,email:/^([a-z\d\.-]+)@([a-z\d-]+)\.([a-z]{2,8})(\.[a-z]{2,8})?$/,quantity:/\b([1-9]|10)\b/};t.forEach((t=>{t.addEventListener("keyup",(t=>{var n;n=t.target,e[t.target.attributes.id.value].test(n.value)?(n.className="form-control is-valid",l[`${n.id}`]=!0):(n.className="form-control is-invalid",l[`${n.id}`]=!1)}))}))}(),(0,b.F)()},161:(t,e,n)=>{n.d(e,{KY:()=>c,qU:()=>u,ts:()=>p,XW:()=>m});var a=n(9),r=n(558),s=n(880),o=n(274),i=n(102),d=n(82);function l(t={},e,n){if(t.el)document.querySelector(t.el).addEventListener(e,n);else if(t.els){document.querySelectorAll(t.els).forEach((t=>{t.addEventListener(e,n)}))}}const c=t=>l({el:"#addProduct"},"click",(()=>{try{o.N.add(t),(0,i.F)()}catch(t){(0,a.j)("#error","Erreur lors de l'ajout d'un article au panier","danger",!1),console.error(t)}})),u=()=>l({els:".delProduct"},"click",(t=>{try{let e=t.target.closest("button").dataset.id;o.N.del(e),h(),t.target.style.setProperty("--animate-duration","1s"),y(t.target.closest("button"),2),(0,i.F)()}catch(t){(0,a.j)("#error","Erreur lors de la suppression d'un produit","danger",!1),console.error(t)}})),m=()=>l({els:"[id^=cartQuantity]"},"change",(t=>{try{let e=t.target.dataset.id;o.N.updateQuantity(e,t.target),function(t,e){let n=o.N.find(e),a=(0,r.Ow)(t,2).nextElementSibling;a.style.setProperty("--animate-duration","0.3s"),(0,d.V)(a,"fadeOut").then((()=>{(0,d.V)(a,"fadeIn"),a.innerHTML=(0,s.Y)(n.price*n.quantity)}))}(t.target,e),h(),(0,i.F)()}catch(t){(0,a.j)("#error","Erreur lors du changement de quantité","danger",!1),console.error(t)}})),p=()=>l({el:"#clearCart"},"click",(t=>{try{o.N.delAll(),y(t.target.closest("button"),4),(0,i.F)()}catch(t){(0,a.j)("#error","Erreur lors de la suppression du panier","danger",!1),console.error(t)}}));function h(){let t=document.getElementById("totalPrice"),e=document.getElementById("totalProduct");e.style.setProperty("--animate-duration","0.65s"),t.style.setProperty("--animate-duration","0.65s"),(0,d.V)(t,"fadeOut").then((()=>{(0,d.V)(t,"fadeIn"),t.innerHTML=`<b>${(0,s.Y)(o.N.totalPrice())}</b>`})),(0,d.V)(e,"fadeOut").then((()=>{(0,d.V)(e,"fadeIn"),e.innerHTML=`<b>${o.N.count()} articles</b>`}))}function y(t,e){let n=(0,r.Ow)(t,e);n.style.setProperty("--animate-duration","1s"),(0,d.V)(n,"bounceOut").then((()=>{n.remove(),o.N.isEmpty()&&(document.querySelector(".table-responsive").innerHTML="Votre panier est vide",document.querySelector("#formSection").remove())}))}},102:(t,e,n)=>{n.d(e,{F:()=>r});var a=n(274);function r(){var t=document.getElementById("cart-nb");if(t&&0===a.N.count()||void 0===a.N.count())t.innerHTML="";else{let t=`\n            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">\n                ${a.N.count()}\n                <span class="visually-hidden">Articles du panier</span>\n            </span>\n            `;document.getElementById("cart-nb").innerHTML=t}}},506:(t,e,n)=>{n.d(e,{_:()=>a});class a{constructor(t,e){this.baseURL=t,this.headers=e}async get(t){return(await fetch(this.baseURL+t,{method:"GET"})).json()}async post(t,e){return(await fetch(this.baseURL+t,{method:"POST",headers:this.headers,body:JSON.stringify(e)})).json()}}},880:(t,e,n)=>{function a(t){var e=t/100+".00";return Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(e)}n.d(e,{Y:()=>a})},274:(t,e,n)=>{n.d(e,{N:()=>s,y:()=>o});var a=n(9);class r{constructor(t){this.name=t}init(){if(null===this.get())var t=[];else t=this.get();return t}set(t){return localStorage.setItem(this.name,JSON.stringify(t))}get(){return JSON.parse(localStorage.getItem(this.name))}find(t){return this.get().find((e=>e._id===t))}updateQuantity(t,e){var n=this.get(),a=n.find((e=>e._id===t)),r=parseInt(e.value);a&&(a.quantity=parseInt(r)),this.set(n)}del(t){var e=this.get().findIndex((e=>e._id===t)),n=this.get();n.splice(e,1),this.set(n)}delAll(){localStorage.removeItem(this.name)}totalPrice(){let t=0;return this.get().forEach((e=>{t+=e.price*e.quantity})),t}isEmpty(){if(null===this.get()||0===this.get().length)return!0}}const s=new class extends r{add(t){this.set(this.init());let e=this.get();var n=e.find((e=>e._id===t._id));t.quantity=parseInt(document.getElementById("btnQuantity").value),n?n.quantity>=10?(0,a.j)(".card-body","Il ne reste que 10 produits en stock","danger",!0):(n.quantity+=parseInt(t.quantity),(0,a.j)(".card-body","Le produit a été ajouter au panier","success",!0)):(e.push({name:t.name,imageUrl:t.imageUrl,_id:t._id,quantity:t.quantity,price:t.price}),(0,a.j)(".card-body","Le produit a été ajouter au panier","success",!0)),this.set(e)}count(){var t;if(null!==this.get()&&0!==this.get())return t=0,this.get().forEach((e=>{t+=e.quantity})),t;t=null}}("cart"),o=new class extends r{total(){let t=0;return s.get().forEach((e=>{t+=e.price*e.quantity})),t}add(t){this.set(this.init());let e=this.get(),n=new Date;e.push({contact:t.contact,orderId:t.orderId,products:t.products,date:n,totalPrice:this.total()}),this.set(e)}}("confirmation")}},t=>{var e;e=857,t(t.s=e)}]);